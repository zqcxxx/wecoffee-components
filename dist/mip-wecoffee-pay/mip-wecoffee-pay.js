(window.MIP=window.MIP||[]).push({name:"mip-wecoffee-pay",func:function(){var e=function(e){var n={};function t(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(a,i,function(n){return e[n]}.bind(null,i));return a},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/",t(t.s=79)}({1:function(e,n){e.exports=__mipComponentsWebpackHelpers__["vue-loader/lib/runtime/componentNormalizer"]},41:function(e,n,t){var a=t(72);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,t(8).default)("4935fd34",a,!0,{})},7:function(e,n){e.exports=__mipComponentsWebpackHelpers__["css-loader/lib/css-base"]},71:function(e,n,t){"use strict";var a=t(41);t.n(a).a},72:function(e,n,t){(e.exports=t(7)(!1)).push(["5970e602433f9ea8",'\n.wrapper[data-v-c5fca3ec] {\n  margin: 0 auto;\n  /* text-align: center; */\n  height: 100%;\n}\n.orderError[data-v-c5fca3ec] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  height: 70vh;\n}\n.exprieTime[data-v-c5fca3ec] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  font-size: 3.2vw;\n  height: 10vw;\n  background-color: #ebf2f8;\n  color: #666666;\n}\n.userinf[data-v-c5fca3ec] {\n  padding: 1em;\n  margin-top: 5px;\n  border-top: 10px solid rgba(0, 0, 0, 0.08)\n}\n.userinf-r[data-v-c5fca3ec] {\n  padding-left: 20px;\n}\n.userfont[data-v-c5fca3ec] {\n  text-align: justify;\n  padding-right: 5px;\n  width: 80px;\n  height: 100%;\n  display: inline-block;\n  vertical-align: top;\n  opacity: 0.8;\n  color: darkgray;\n}\n.userfont[data-v-c5fca3ec]::after {\n  content: "";\n  display: inline-block;\n  width: 100%;\n  overflow: hidden;\n  height: 0;\n}\n.footer[data-v-c5fca3ec] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  background: #fff;\n  margin-top: 10px;\n  padding: 5px;\n  -ms-flex-pack: distribute;\n      justify-content: space-around;\n}\n.pay[data-v-c5fca3ec] {\n  position: absolute;\n  top: 50px;\n}\n.coffee-contain[data-v-c5fca3ec] {\n  background-color: #fff;\n  padding: 0 4vw;\n  font-size: 4vw;\n  /* margin-top: 12px; */\n}\n.coffee-contain div[data-v-c5fca3ec]:last-child {\n  border-bottom: 0;\n}\n.coffee-item[data-v-c5fca3ec] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  border-bottom: 0.7px solid rgba(0, 0, 0, 0.08);\n}\n.coffee-discribe[data-v-c5fca3ec] {\n  -webkit-box-flex: 5;\n      -ms-flex: 5;\n          flex: 5;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  margin: 2vh 0;\n}\n.coffee-price[data-v-c5fca3ec] {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.coffee-amount[data-v-c5fca3ec] {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  font-size: 3.2vw;\n  opacity: 0.7;\n}\n.coffee-all-price[data-v-c5fca3ec] {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: right;\n      -ms-flex-pack: right;\n          justify-content: right;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.coffee-img[data-v-c5fca3ec] {\n  width: 16vw;\n  min-width: 16vw;\n  max-height: 16vw;\n}\n.coffee-name[data-v-c5fca3ec] {\n  margin-left: 3vw;\n  /* line-height: 10vw; */\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  /* justify-content: center; */\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.coffee-title[data-v-c5fca3ec] {\n  font-size: 3.7vw;\n  margin-bottom: 0.25px;\n  text-align: left;\n}\n.coffee-options[data-v-c5fca3ec] {\n  font-size: 3.2vw;\n  opacity: 0.5;\n  text-align: left;\n}\n.top[data-v-c5fca3ec] {\n  text-align: left;\n  margin: 6px 0px 0px 13px;\n  opacity: 0.7;\n}\n',""])},79:function(e,n,t){"use strict";t.r(n);var a={firstInviewCallback:function(){var e=MIP.sandbox.this(this);e.$on("getOrder",function(n){MIP.sandbox.MIP.setData({payConfig:{sessionId:n.sessionId}}),e.getOrder()})},props:{payConfig:{type:Object,default:function(){return{}}},info:{type:Object,required:!0,default:function(){return{userInfo:{}}}}},data:function(){return{goodsdata:{},orderTotal:0,extime:0,userAddress:{},msg:"",orderId:0,sesId:"",sta:!0}},computed:{totalPrice:function(){var e=0;return Array.prototype.forEach.call(MIP.sandbox.this(this).goodsdata,function(n){e+=parseFloat(n.sku.priceCent*n.count/100)}),e},limTime:function(){return function(e){var n=Math.floor(e/86400),t=Math.floor((e-3600*n*24)/3600),a=Math.floor((e-3600*n*24-3600*t)/60);a<10&&(a="0"+a);var i=Math.floor(e-3600*n*24-3600*t-60*a);i<10&&(i="0"+i);var s="";return 0!==n?s+=n+"天"+t+"时"+a+"分"+i+"秒":0!==t?s+=t+"时"+a+"分"+i+"秒":0!==a?s+=a+"分"+i+"秒":0!==i&&(s+=i+"秒"),s}(MIP.sandbox.this(this).extime)}},mounted:function(){MIP.sandbox.MIP.setData({payConfig:{postData:{orderId:MIP.sandbox.this(this).getOrderId()}}})},methods:{getOrder:function(){var e=MIP.sandbox.this(this);fetch("/api/order/"+MIP.sandbox.this(this).getOrderId(),{method:"get",credentials:"include"}).then(function(e){return e.json()}).then(function(n){0!==n.status?(e.msg="订单获取失败",e.sta=!e.sta):10!=+n.data.status?(e.msg="订单已支付",e.sta=!e.sta):+n.data.exprieTime<=0?(e.msg="订单已过期",e.sta=!e.sta):(e.orderId=n.data.id,e.goodsdata=n.data.items,e.userAddress=n.data.address,e.extime=n.data.exprieTime,e.updataTime(),MIP.sandbox.MIP.setData({payConfig:{fee:e.totalPrice}}))}).catch(function(e){console.log(e)})},getOrderId:function(){return MIP.sandbox.this(this).getQueryString("orderId")},getQueryString:function(e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=MIP.sandbox.window.location.search.substr(1).match(n);return null!=t?unescape(t[2]):null},updataTime:function(){var e=MIP.sandbox.this(this);--MIP.sandbox.this(this).extime||MIP.sandbox.this(this).getOrderList(),setTimeout(function(){e.updataTime()},1e3)},getOrderList:function(){MIP.sandbox.window.MIP.viewer.open("./orderList.html?r="+(new Date).getTime(),{isMipLink:!0})}},prerenderAllowed:function(){return!0}},i=(t(71),t(1)),s=t.n(i)()(a,function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"wrapper"},[e.sta?t("div",[t("div",{staticClass:"exprieTime"},[e._v("\n      请在 "),t("span",{staticClass:"sec"},[e._v(e._s(e.limTime))]),e._v(" 内完成支付，过时订单交自动取消\n    ")]),e._v(" "),t("div",{staticClass:"top"},[e._v("订单信息")]),e._v(" "),t("div",{staticClass:"coffee-contain"},e._l(e.goodsdata,function(n){return t("div",{key:n.id,staticClass:"coffee-item"},[t("span",{staticClass:"coffee-discribe"},[t("mip-img",{staticClass:"coffee-img",attrs:{src:n.sku.product.imageUri,layout:"responsive",width:"2vw",height:"2vh"}}),e._v(" "),t("span",{staticClass:"coffee-name"},[t("div",{staticClass:"coffee-title"},[e._v(e._s(n.sku.product.name))]),e._v(" "),t("div",{staticClass:"coffee-options"},[e._v(e._s(Object.values(JSON.parse(n.extra).spec).join("/").substring(0,40)))])])],1),e._v(" "),t("span",{staticClass:"coffee-amount"},[e._v("x"+e._s(n.count))]),e._v(" "),t("span",{staticClass:"coffee-all-price"},[e._v("￥"+e._s(n.sku.priceCent*n.count/100))])])})),e._v(" "),t("div",{staticClass:"userinf"},[t("div",{staticClass:"userinf-i"},[t("span",{staticClass:"userfont"},[e._v("订单号")]),e._v(":"),t("span",{staticClass:"userinf-r"},[e._v(e._s(e.orderId))])]),e._v(" "),t("div",{staticClass:"userinf-i"},[t("span",{staticClass:"userfont"},[e._v("商品总金额")]),e._v(":"),t("span",{staticClass:"userinf-r",staticStyle:{color:"red"}},[e._v("￥"+e._s(e.totalPrice))])]),e._v(" "),t("div",{staticClass:"userinf-i"},[t("span",{staticClass:"userfont"},[e._v("收货人")]),e._v(":"),t("span",{staticClass:"userinf-r"},[e._v(e._s(e.userAddress.name))])]),e._v(" "),t("div",{staticClass:"userinf-i"},[t("span",{staticClass:"userfont"},[e._v("电话")]),e._v(":"),t("span",{staticClass:"userinf-r"},[e._v(e._s(e.userAddress.phoneNumber))])])]),e._v(" "),t("div",{staticClass:"submitBtn flex-center",attrs:{ripple:"",on:"tap:payDialog.toggle"}},[e._v("确定支付")])]):e._e(),e._v(" "),e.sta?e._e():t("div",{staticClass:"orderError"},[t("mip-showcase-icon",{staticClass:"abc mip-element mip-layout-container",attrs:{type:"waring"}},[t("svg",{staticClass:"rt-svg-icon"},[t("use",{attrs:{"xlink:href":"#waring"}})])]),e._v(" "),t("span",{staticClass:"error"},[e._v(e._s(e.msg))])],1)])},[],!1,null,"c5fca3ec",null);s.options.__file="mip-wecoffee-pay.vue";n.default=s.exports},8:function(e,n){e.exports=__mipComponentsWebpackHelpers__["vue-style-loader/lib/addStylesClient"]}});e=e.default||e,MIP["function"==typeof e?"registerCustomElement":"registerVueCustomElement"]("mip-wecoffee-pay",e)}});