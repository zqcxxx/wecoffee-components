!function(){var e=function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=76)}({1:function(e,t){e.exports=__mipComponentsWebpackHelpers__["vue-loader/lib/runtime/componentNormalizer"]},14:function(e,t){e.exports=__mipComponentsWebpackHelpers__["css-loader/lib/css-base"]},15:function(e,t){e.exports=__mipComponentsWebpackHelpers__["vue-style-loader/lib/addStylesClient"]},40:function(e,t,n){var i=n(69);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n(15).default)("6a0a433b",i,!0,{})},68:function(e,t,n){"use strict";var i=n(40);n.n(i).a},69:function(e,t,n){(e.exports=n(14)(!1)).push(["61885c5a82640ca1","\n.wrapper[data-v-b1bdf0e4] {\n  margin: 0 auto;\n  text-align: center;\n  height: 100%;\n}\n.orderError[data-v-b1bdf0e4] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  height: 70vh;\n}\n.exprieTime[data-v-b1bdf0e4] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  font-size: 3.2vw;\n  height: 10vw;\n  background-color: #ebf2f8;\n  color: #666666;\n}\n.userinf[data-v-b1bdf0e4] {\n  text-align: left;\n  padding: 1em;\n  margin-top: 5px;\n  border-top: 10px solid rgba(0, 0, 0, 0.08)\n}\n.userinf-i[data-v-b1bdf0e4] {\n  padding-top: 4vw;\n}\n.userfont[data-v-b1bdf0e4] {\n  color: #999;\n  padding-right: 5px;\n}\n.footer[data-v-b1bdf0e4] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  background: #fff;\n  margin-top: 10px;\n  padding: 5px;\n  -ms-flex-pack: distribute;\n      justify-content: space-around;\n}\n.pay[data-v-b1bdf0e4] {\n  position: absolute;\n  top: 50px;\n}\n.coffee-contain[data-v-b1bdf0e4] {\n  background-color: #fff;\n  padding: 0 4vw;\n  font-size: 4vw;\n  /* margin-top: 12px; */\n}\n.coffee-contain div[data-v-b1bdf0e4]:last-child {\n  border-bottom: 0;\n}\n.coffee-item[data-v-b1bdf0e4] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  border-bottom: 0.7px solid rgba(0, 0, 0, 0.08);\n}\n.coffee-discribe[data-v-b1bdf0e4] {\n  -webkit-box-flex: 5;\n      -ms-flex: 5;\n          flex: 5;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  margin: 2vh 0;\n}\n.coffee-price[data-v-b1bdf0e4] {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.coffee-amount[data-v-b1bdf0e4] {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  font-size: 3.2vw;\n  opacity: 0.7;\n}\n.coffee-all-price[data-v-b1bdf0e4] {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: right;\n      -ms-flex-pack: right;\n          justify-content: right;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.coffee-img[data-v-b1bdf0e4] {\n  width: 16vw;\n  min-width: 16vw;\n  max-height: 16vw;\n}\n.coffee-name[data-v-b1bdf0e4] {\n  margin-left: 3vw;\n  /* line-height: 10vw; */\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  /* justify-content: center; */\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.coffee-title[data-v-b1bdf0e4] {\n  font-size: 3.7vw;\n  margin-bottom: 0.25px;\n  text-align: left;\n}\n.coffee-options[data-v-b1bdf0e4] {\n  font-size: 3.2vw;\n  opacity: 0.5;\n  text-align: left;\n}\n.top[data-v-b1bdf0e4] {\n  text-align: left;\n  margin: 6px 0px 0px 13px;\n  opacity: 0.7;\n}\n",""])},76:function(e,t,n){"use strict";n.r(t);var i=function(e){var t=Math.floor(e/86400),n=Math.floor((e-3600*t*24)/3600),i=Math.floor((e-3600*t*24-3600*n)/60);i<10&&(i="0"+i);var a=Math.floor(e-3600*t*24-3600*n-60*i);a<10&&(a="0"+a);var s="";return 0!==t?s+=t+"天"+n+"时"+i+"分"+a+"秒":0!==n?s+=n+"时"+i+"分"+a+"秒":0!==i?s+=i+"分"+a+"秒":0!==a&&(s+=a+"秒"),s},a={firstInviewCallback:function(){var e=MIP.sandbox.this(this);e.$on("getOrder",function(t){e.getOrder()})},props:{payConfig:{type:Object,default:function(){return{}}},info:{type:Object,required:!0,default:function(){return{userInfo:{}}}}},data:function(){return{goodsdata:{},orderTotal:0,extime:0,userAddress:{},msg:"",orderId:0,sesId:"",sta:!0}},computed:{totalPrice:function(){var e=0;return Array.prototype.forEach.call(MIP.sandbox.this(this).goodsdata,function(t){e+=parseFloat(t.sku.priceCent*t.count/100)}),e},limTime:function(){return i(MIP.sandbox.this(this).extime)}},mounted:function(){var e=MIP.sandbox.this(this);MIP.sandbox.MIP.setData({payConfig:{postData:{orderId:MIP.sandbox.this(this).getOrderId()}}}),setTimeout(function(){MIP.sandbox.MIP.setData({payConfig:{fee:e.totalPrice}})},500),setTimeout(function(){MIP.sandbox.MIP.setData({payConfig:{sessionId:e.info.sessionId}})},500),console.log(i(MIP.sandbox.this(this).extime))},methods:{getOrder:function(){var e=MIP.sandbox.this(this);fetch("/api/order/"+MIP.sandbox.this(this).getOrderId(),{method:"get",credentials:"include"}).then(function(e){return e.json()}).then(function(t){0!==t.status?(e.msg="订单获取失败",e.sta=!e.sta):10!=+t.data.status?(e.msg="订单已支付",e.sta=!e.sta):+t.data.exprieTime<=0?(e.msg="订单已过期",e.sta=!e.sta):(e.orderId=t.data.id,e.goodsdata=t.data.items,e.userAddress=t.data.address,e.extime=t.data.exprieTime,e.updataTime())}).catch(function(e){console.log(e)})},getOrderId:function(){return MIP.sandbox.this(this).getQueryString("orderId")},getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=MIP.sandbox.window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null},updataTime:function(){var e=MIP.sandbox.this(this);--MIP.sandbox.this(this).extime||MIP.sandbox.this(this).getOrderList(),setTimeout(function(){e.updataTime()},1e3)},countEle:function(e){var t=Math.floor(e/86400),n=Math.floor((e-3600*t*24)/3600),i=Math.floor((e-3600*t*24-3600*n)/60);i<10&&(i="0"+i);var a=Math.floor(e-3600*t*24-3600*n-60*i);a<10&&(a="0"+a);var s="";return 0!==t?s+=t+"天"+n+"时"+i+"分"+a+"秒":0!==n?s+=n+"时"+i+"分"+a+"秒":0!==i?s+=i+"分"+a+"秒":0!==a&&(s+=a+"秒"),s},getOrderList:function(){MIP.sandbox.window.MIP.viewer.open("./orderList.html?r="+(new Date).getTime(),{isMipLink:!0})}},prerenderAllowed:function(){return!0}},s=(n(68),n(1)),o=n.n(s)()(a,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrapper"},[e.sta?n("div",[n("div",{staticClass:"exprieTime"},[e._v("\n      请在 "),n("span",{staticClass:"sec"},[e._v(e._s(e.limTime))]),e._v(" 内完成支付，过时订单交自动取消\n    ")]),e._v(" "),n("div",{staticClass:"top"},[e._v("订单信息")]),e._v(" "),n("div",{staticClass:"coffee-contain"},e._l(e.goodsdata,function(t){return n("div",{key:t.id,staticClass:"coffee-item"},[n("span",{staticClass:"coffee-discribe"},[n("mip-img",{staticClass:"coffee-img",attrs:{src:t.sku.product.imageUri,layout:"responsive",width:"2vw",height:"2vh"}}),e._v(" "),n("span",{staticClass:"coffee-name"},[n("div",{staticClass:"coffee-title"},[e._v(e._s(t.sku.product.name))]),e._v(" "),n("div",{staticClass:"coffee-options"},[e._v(e._s(Object.values(JSON.parse(t.extra).spec).join("/").substring(0,40)))])])],1),e._v(" "),n("span",{staticClass:"coffee-amount"},[e._v("x"+e._s(t.count))]),e._v(" "),n("span",{staticClass:"coffee-all-price"},[e._v("￥"+e._s(t.sku.priceCent*t.count/100))])])})),e._v(" "),n("div",{staticClass:"userinf"},[n("div",{staticClass:"userinf-i"},[n("span",{staticClass:"userfont"},[e._v("订单号:")]),e._v(e._s(e.orderId)+"\n      ")]),e._v(" "),n("div",{staticClass:"userinf-i",staticStyle:{color:"red"}},[n("span",{staticClass:"userfont"},[e._v("商品总金额:")]),e._v("￥"+e._s(e.totalPrice)+"\n      ")]),e._v(" "),n("div",{staticClass:"userinf-i"},[n("span",{staticClass:"userfont"},[e._v("收货人:")]),e._v(e._s(e.userAddress.name)+"\n      ")]),e._v(" "),n("div",{staticClass:"userinf-i"},[n("span",{staticClass:"userfont"},[e._v("电话:")]),e._v(e._s(e.userAddress.phoneNumber)+"\n      ")])]),e._v(" "),n("div",{staticClass:"submitBtn flex-center",attrs:{ripple:"",on:"tap:payDialog.toggle"}},[e._v("确定支付")])]):e._e(),e._v(" "),e.sta?e._e():n("div",{staticClass:"orderError"},[n("mip-showcase-icon",{staticClass:"abc mip-element mip-layout-container",attrs:{type:"waring"}},[n("svg",{staticClass:"rt-svg-icon"},[n("use",{attrs:{"xlink:href":"#waring"}})])]),e._v(" "),n("span",{staticClass:"error"},[e._v(e._s(e.msg))])],1)])},[],!1,null,"b1bdf0e4",null);o.options.__file="mip-wecoffee-pay.vue";t.default=o.exports}});e=e.default||e,MIP["function"==typeof e?"registerCustomElement":"registerVueCustomElement"]("mip-wecoffee-pay",e)}();